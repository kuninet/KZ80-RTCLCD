;
; KZ80-MON Output Library
;             KUNI-NET 2020
;

CR		EQU	0DH
LF		EQU	0AH
ESC		EQU	1BH
CTRLC	EQU	03H
CLS		EQU	0CH
SPC		EQU	20h
NULL	EQU 00h
BEEP	EQU 07h
BS		EQU 08h
TAB		EQU 09h
DEL		EQU 7Fh


;------------------------------------------------------------------------------
; 文字数指定出力
;==============================================================================
; IN:
;   HL  String Address
;   B   CHAR COUNT
;------------------------------------------------------------------------------
NSTRPR:
    LD A,(HL)
    CALL CPRINT
    INC HL
    DEC B
    RET Z
    JR NSTRPR

;------------------------------------------------------------------------------
; 文字列出力
;==============================================================================
; IN:
;   HL  String Address (StringZ)
;------------------------------------------------------------------------------
STRPR:
    LD A,(HL)
    OR A
    RET Z
    CALL CPRINT
    INC HL
    JR STRPR

;------------------------------------------------------------------------------
; 文字出力 (CRLF対応)
; IN: A - キャラクタ
; RET: なし
;------------------------------------------------------------------------------
CPRINT:
    CP 0Dh
    JR Z,CRLF_PRINT
    RST 08h
    RET

;------------------------------------------------------------------------------
; CRLF出力 (CRLF対応)
;------------------------------------------------------------------------------
CRLF_PRINT:
    LD A,0DH
    RST 08H
    LD A,0AH
    RST 08h
    RET

;------------------------------------------------------------------------------
; ブランク出力 
;------------------------------------------------------------------------------
SPC_PRINT:
    LD A,SPC
    RST 08H
    RET
;

;
;------------------------------------
; (strlen) 文字列長をAレジスタへ返す
;------------------------------------
STRLEN:
	PUSH HL
	PUSH BC
	LD C,0
_STR_LEN_LOOP:
	LD A,(HL)
	CP NULL
	JR Z,_STR_LEN_EXIT
	INC HL
	INC C
	JR _STR_LEN_LOOP
;
_STR_LEN_EXIT:
	LD A,C
	POP BC
	POP HL
	RET
;
